<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: main.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: main.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Initializes the comic properties and fetches the comic based on the identifier specified.
 */
init = () => {
    comic.comicAuthor = "Randall Munroe"
    comic.firstIdentifier = 1
    comic.shopUrl = "https://store.kde.org/"

    const { identifierSpecified, Page, User } = comic
    getComic(identifierSpecified, identifierSpecified ? Page : User)
}

/**
 * Handles the JSON data retrieved for the current comic.
 * @param {string} id - The identifier for the retrieved data.
 * @param {string} data - The JSON data string.
 */
pageRetrieved = (id, data) => {
    let obj

    try {
        obj = typeof data === "string" &amp;&amp; JSON.parse(data)
    } catch (ex) {
        print(`Error: ${ex}\nTried to parse: ${data}`)
        comic.error()
        return
    }

    const { User, Page, Image } = comic

    switch (id) {
        case User:
            comic.lastIdentifier = obj.num
            getComic(false, Page) // Fetch the comic with the requested identifier
            break
        case Page:
            processComic(id, obj) // Process the comic's JSON data
            break
        case Image:
            print(`Image data received for comic #${comic.identifier} at ${comic.websiteUrl}`)
            return
        default:
            print(`This function is not configured to handle responses with this ID (${id})`)
            if (id !== comic.Image) print(`Data returned: ${data}`)
            comic.error()
            break
    }
}

/**
 * Processes the comic's JSON data and sets the comic properties.
 * @param {string} id - The identifier for the comic.
 * @param {Object} jsonData - The JSON data object.
 */
processComic = (id, jsonData) => {

    const { num, title, alt, img } = jsonData

    print(`json data ${JSON.stringify(jsonData)} identifier ${id} last identifier ${num} title ${title}`)

    // Set objects properties
    comic.title = title
    comic.websiteUrl = `https://xkcd.com/${num}`
    comic.additionalText = alt

    // Set the comic identifier
    comic.identifier = num

    // Requests the actual comic image
    comic.requestPage(img, comic.Image)
}

/**
 * Fetches the latest comic if identifierSpecified is not set, else fetches the comic with the requested number.
 * @param {boolean} identifierSpecified - Indicates if an identifier is specified.
 * @param {string} id - The identifier for the comic.
 */
getComic = (identifierSpecified, id) => comic.requestPage(`https://xkcd.com/${identifierSpecified ? comic.identifier + '/' : ''}info.0.json`, id)</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#getComic">getComic</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#pageRetrieved">pageRetrieved</a></li><li><a href="global.html#processComic">processComic</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Thu Sep 05 2024 10:38:55 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
